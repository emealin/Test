#This space is reserved for the teacher:
#Ex1: NA
#Ex2 (2pts): 
#Ex3 (2pts): 
#Feedback:
#
#
#
#################################################
#Rscript for HW1

#Group nr: 5
#Members:
# Jussi Laitinen
# Oskar Lindman
# Patrik Sunila
# Alina-Emelie Andersson
#Member whose quiz variant is used for coding:
#...

#Question 2. RNGkind(sample.kind = ′Rejection′)
#Combine/modify the Rcode from Exercises 7 and 12 from Lab1 to design an Rfunction which will generate paths of the Generalized Wiener Process (paths should be tagged with path index, drift coefficient and diffusion coefficient).
#SET RANDOM SEED TO 2141.
#Use your Rfunction to generate 6 paths of the Generalized Wiener Process on [0,2.3] (use time-step Δt=0.01) with parameters a=−0.7, b=0.1. Using Rfunction(s) of the Rpackage ggplot2, plot the paths accordingly.
#SET RANDOM SEED TO 2141. Repeat for a=−0.7, b=0 (with everything else the same).
#SET RANDOM SEED TO 2141. Repeat for a=0, b=1 (with everything else the same).

myWienerProcess<-function(T,deltat,R)
{#opening brace of the Rfunction
  t<-seq(from=0,to=T,by=deltat)
  result<-NULL 
  for(r in 1:R)
  {
    z<-cumsum(c(0,sqrt(deltat)*rnorm(n=length(t)-1))) 
    temp<-data.frame(time=t,value=z,rep=paste(r)) 
    result<-rbind(result,temp) 
  } 
  return(result)
  #return the Rvariable 'result' as the value of the Rfunction
}

T<-1 #assign 1 to the Rvariable 'T'
deltat<-0.001 #assign 0.001 to the Rvariable 'deltat'
t<-seq(from=0,to=T,by=deltat) #create a sequence 0,0.001,...,1 
#and assign it to the Rvariable 't'

a<- -0.05
b<-0.04
x<-cumsum(c(0,a*deltat+b*sqrt(deltat)*rnorm(n=length(t)-1)))
temp<-data.frame(time=t,value=x,rep=paste(1), 
                 drift=paste(a),diffusion=paste(b))
ggplot(data=temp,aes(x=time,y=value))+geom_line()
